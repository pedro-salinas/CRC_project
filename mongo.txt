db.attentions.aggregate([ {$match: {hour: 8,month: 9}},{ $lookup: { from: 'programs', localField: 'program', foreignField: '_id', as: 'programInfo'} }, { $unwind: '$programInfo' }, { $lookup: { from: 'kines', localField: 'kine', foreignField: '_id', as: 'kineInfo' } }, { $unwind: '$kineInfo'}, { $lookup: { from: 'clients', localField: 'client', foreignField: '_id', as: 'clientInfo' } }, { $unwind: '$clientInfo'}, { $project: { hour: 1, day: 1, month: 1, year: 1, 'programInfo.name': 1,'kineInfo.name': 1, 'clientInfo.name': 1, state: 1, blocked: 1 } }, {$count: 'totalCount'}] ).pretty()